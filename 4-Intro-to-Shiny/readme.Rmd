---
title: "Introduction to Shiny"
author: "Fluent Data"
date: "2023-06-17"
output: html_document
description: "A tutorial on using the Shiny package in R to build interactive graphs for air quality data analysis."
---

# Introduction to Shiny

Shiny is an R package developed by RStudio that allows you to create interactive graphs. In this tutorial, we will explore the basics of how to use Shiny to build and deploy interactive apps for air quality data analysis.

## Prerequisites

This tutorial assumes no prior knowledge of Shiny. However, it is recommended to familiarize yourself with the resources provided by RStudio on their [Shiny tutorial website](http://shiny.rstudio.com/tutorial/).

## Basics

To create a Shiny app, you need to have two `.R` scripts in the same folder:

1. The user-interface script (ui.R)
2. The server script (server.R)

## `ui.R`

The `ui.R` script defines the layout and appearance of your app. Let's take a look at the `ui.R` script for the "Hello Shiny" example from the RStudio tutorial:

```{r ui.R, eval=FALSE}
library(shiny)

# Define UI for application that draws a histogram
shinyUI(fluidPage(

  # Application title
  titlePanel("Hello Shiny!"),

  # Sidebar with a slider input for the number of bins
  sidebarLayout(
    sidebarPanel(
      sliderInput("bins",
                  "Number of bins:",
                  min = 1,
                  max = 50,
                  value = 30)
    ),

    # Show a plot of the generated distribution
    mainPanel(
      plotOutput("distPlot")
    )
  )
))
```

## `server.R`

The `server.R` script is where you write the code that builds the app.

```{r server.R, eval=FALSE}
library(shiny)

# Define server logic required to draw a histogram
shinyServer(function(input, output) {

  # Expression that generates a histogram. The expression is
  # wrapped in a call to renderPlot to indicate that:
  #
  #  1) It is "reactive" and therefore should be automatically
  #     re-executed when inputs change
  #  2) Its output type is a plot

  output$distPlot <- renderPlot({
    x    <- faithful[, 2]  # Old Faithful Geyser data
    bins <- seq(min(x), max(x), length.out = input$bins + 1)

    # draw the histogram with the specified number of bins
    hist(x, breaks = bins, col = 'darkgray', border = 'white')
  })

})
```

## Running the App Locally

To run the app locally, use the `runApp()` function and specify the directory that contains the `ui.R` and `server.R` scripts. For example, if the scripts are in a folder called "ChicagoApp" in your working directory, you would run the app using the following code:

```{r runApp, eval=FALSE}
runApp(appDir = "ChicagoApp")
```

## Chicago Air App

Let's create a simple app using the "chicago_air" dataset for air quality analysis.

### `ui.R`

```{r ui_chicago_air.R, eval=FALSE}
library(shiny)

# Define UI for application that plots time series
shinyUI(fluidPage(

  # Application title
  titlePanel("Chicago Air"),

  # Sidebar with a dropdown for selecting a parameter
  sidebarLayout(
    sidebarPanel(
      selectInput("parameter",
                  "Select Parameter:",
                  choices = c("Ozone", "Temperature", "Solar Radiation"),
                  selected = "Ozone")
    ),

    # Show a plot of the time series
    mainPanel(
      plotOutput("timePlot")
    )
  )
))
```

### `server.R`

```{r server_chicago_air.R, eval=FALSE}
library(shiny)
library(region5air)

# Load the chicago_air dataset
data(chicago_air)
chicago_air$date <- as.Date(chicago_air$date)

# Define server logic required to plot the time series
shinyServer(function(input, output) {
  
  output$timePlot <- renderPlot({
    plot(chicago_air$date, chicago_air[, input$parameter], type = "l",
         xlab = "Date", ylab = input$parameter)
  })
  
})
```

To run the Chicago Air app, you can use the `runApp()` function and specify the directory containing the `ui.R` and `server.R` scripts. For example:

```{r runApp_chicago_air.R, eval=FALSE}
runApp(appDir = "ChicagoApp")
```

## Exercises

These exercises accompany the Intro to Shiny tutorial.

1. Create a folder called "ChicagoApp" in your working directory, and place the `ui.R` and `server.R` scripts from the tutorial in that folder. Run the app using `runApp()`.

2. Add a table of the data to the bottom of the application. Use `dataTableOutput()` in the `ui.R` script and `renderDataTable()` in the `server.R` script.

3. Add a Leaflet map to the application with a marker at the location of the monitor (latitude 42.14 and longitude -87.79923).

4. Replace the base R plot with a time series plot from the `dygraphs` package.

## Revisions

- Updated the description to be more concise and accurate.
- Added a prerequisites section to highlight the recommended resources.
- Renamed the exercises section and organized the exercise solutions.
- Updated code blocks to include syntax highlighting.
- Updated the "Chicago Air" app to use base R plotting functions for simplicity.
- Added a revisions section to document the changes made.

Overall, the changes were made to improve clarity and readability, and to provide more relevant and up-to-date information for air quality data analysts.